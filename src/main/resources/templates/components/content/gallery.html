<!-- ============================================
     GALLERY COMPONENT (C-07)
     Image grid with lightbox
     ============================================ -->

<!-- Basic Gallery Grid -->
<th:block th:fragment="gallery(images)">
    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" x-data="{ lightbox: false, currentImage: null }">

        <!-- Gallery Items -->
        <div th:each="image : ${images}"
            @click="lightbox = true; currentImage = { src: '[[${image.src}]]', alt: '[[${image.alt}]]', caption: '[[${image.caption}]]' }"
            class="aspect-square rounded-xl overflow-hidden cursor-pointer group">
            <img th:src="${image.src}" th:alt="${image.alt}"
                class="w-full h-full object-cover transition-transform duration-300 group-hover:scale-110"
                loading="lazy" />
        </div>

        <!-- Lightbox Modal -->
        <div x-show="lightbox" x-transition:enter="transition ease-out duration-200"
            x-transition:enter-start="opacity-0" x-transition:enter-end="opacity-100"
            x-transition:leave="transition ease-in duration-150" x-transition:leave-start="opacity-100"
            x-transition:leave-end="opacity-0" @keydown.escape.window="lightbox = false"
            class="fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-4" x-cloak>

            <!-- Close Button -->
            <button @click="lightbox = false" class="absolute top-4 right-4 btn btn-circle btn-ghost text-white">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                    stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>

            <!-- Image -->
            <img :src="currentImage?.src" :alt="currentImage?.alt" class="max-w-full max-h-[80vh] rounded-lg"
                @click.stop />

            <!-- Caption -->
            <p x-show="currentImage?.caption" x-text="currentImage?.caption"
                class="absolute bottom-8 left-1/2 transform -translate-x-1/2 text-white text-center max-w-lg"></p>
        </div>
    </div>
</th:block>

<!-- Masonry Gallery -->
<th:block th:fragment="galleryMasonry(images)">
    <div class="columns-2 md:columns-3 lg:columns-4 gap-4 space-y-4"
        x-data="{ lightbox: false, currentImage: null, currentIndex: 0 }">

        <div th:each="image, iterStat : ${images}"
            @click="lightbox = true; currentImage = '[[${image.src}]]'; currentIndex = [[${iterStat.index}]]"
            class="break-inside-avoid rounded-xl overflow-hidden cursor-pointer group">
            <img th:src="${image.src}" th:alt="${image.alt}"
                class="w-full transition-transform duration-300 group-hover:scale-105" loading="lazy" />
        </div>

        <!-- Lightbox -->
        <div th:replace="~{components/content/gallery :: lightboxModal}"></div>
    </div>
</th:block>

<!-- Portfolio Gallery (with overlay info) -->
<th:block th:fragment="galleryPortfolio(items)">
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <div th:each="item : ${items}" class="group relative aspect-[4/3] rounded-xl overflow-hidden cursor-pointer">

            <img th:src="${item.image}" th:alt="${item.title}"
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                loading="lazy" />

            <!-- Overlay -->
            <div
                class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col justify-end p-4">
                <h3 class="text-white font-semibold" th:text="${item.title}">Title</h3>
                <p th:if="${item.category}" class="text-white/70 text-sm" th:text="${item.category}">Category</p>
            </div>
        </div>
    </div>
</th:block>

<!-- Gallery with Tabs (Categories) -->
<th:block th:fragment="galleryTabbed(categories)">
    <div x-data="{ activeTab: 'all' }">
        <!-- Category Tabs -->
        <div class="flex flex-wrap gap-2 mb-6">
            <button @click="activeTab = 'all'" class="btn btn-sm"
                :class="activeTab === 'all' ? 'btn-primary' : 'btn-ghost'">
                Tümü
            </button>
            <button th:each="cat : ${categories}" @click="activeTab = '[[${cat.id}]]'" class="btn btn-sm"
                :class="activeTab === '[[${cat.id}]]' ? 'btn-primary' : 'btn-ghost'"
                th:text="${cat.label}">Category</button>
        </div>

        <!-- Images -->
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
            <th:block th:each="cat : ${categories}">
                <div th:each="image : ${cat.images}" x-show="activeTab === 'all' || activeTab === '[[${cat.id}]]'"
                    x-transition class="aspect-square rounded-xl overflow-hidden">
                    <img th:src="${image.src}" class="w-full h-full object-cover" loading="lazy" />
                </div>
            </th:block>
        </div>
    </div>
</th:block>

<!-- Lightbox Modal Fragment -->
<th:block th:fragment="lightboxModal">
    <div x-show="lightbox" x-transition @keydown.escape.window="lightbox = false"
        class="fixed inset-0 z-50 flex items-center justify-center bg-black/90 p-4" x-cloak>

        <button @click="lightbox = false" class="absolute top-4 right-4 btn btn-circle btn-ghost text-white">✕</button>

        <img :src="currentImage" class="max-w-full max-h-[85vh] rounded-lg" @click.stop />
    </div>
</th:block>