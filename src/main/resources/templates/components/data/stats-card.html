<!-- ============================================
     STATS CARD COMPONENT (D-03)
     KPI and statistics display
     ============================================ -->

<!-- Single Stat Card -->
<th:block th:fragment="statsCard(icon, label, value, change, changeLabel)">
    <div class="stat bg-base-100 rounded-xl shadow-md p-4">
        <div class="stat-figure text-primary" th:if="${icon != null}">
            <span class="text-3xl" th:utext="${icon}"></span>
        </div>
        <div class="stat-title text-base-content/60" th:text="${label}">Label</div>
        <div class="stat-value text-2xl" th:text="${value}">0</div>
        <div class="stat-desc" th:if="${change != null}">
            <span th:classappend="${change > 0} ? 'text-success' : 'text-error'">
                <span th:if="${change > 0}">↑</span>
                <span th:if="${change < 0}">↓</span>
                <span th:text="${#numbers.formatDecimal(change, 1, 1)} + '%'"></span>
            </span>
            <span th:if="${changeLabel}" class="text-base-content/50 ml-1" th:text="${changeLabel}"></span>
        </div>
    </div>
</th:block>

<!-- Stats Row (Horizontal) -->
<th:block th:fragment="statsRow(stats)">
    <div class="stats stats-horizontal shadow w-full bg-base-100 overflow-x-auto">
        <div th:each="stat : ${stats}" class="stat">
            <div class="stat-figure" th:if="${stat.icon != null}"
                th:classappend="${stat.color != null} ? 'text-' + ${stat.color} : 'text-primary'">
                <span class="text-2xl" th:utext="${stat.icon}"></span>
            </div>
            <div class="stat-title" th:text="${stat.label}">Label</div>
            <div class="stat-value" th:classappend="${stat.color != null} ? 'text-' + ${stat.color} : ''"
                th:text="${stat.value}">0</div>
            <div class="stat-desc" th:if="${stat.desc != null}" th:text="${stat.desc}"></div>
        </div>
    </div>
</th:block>

<!-- Stats Grid -->
<th:block th:fragment="statsGrid(stats, columns)">
    <div class="grid gap-4" th:classappend="${columns == 2} ? 'grid-cols-1 sm:grid-cols-2' : 
                         (${columns == 3} ? 'grid-cols-1 sm:grid-cols-2 lg:grid-cols-3' : 
                         'grid-cols-1 sm:grid-cols-2 lg:grid-cols-4')">
        <div th:each="stat : ${stats}"
            th:replace="~{components/data/stats-card :: statsCard(${stat.icon}, ${stat.label}, ${stat.value}, ${stat.change}, ${stat.changeLabel})}">
        </div>
    </div>
</th:block>

<!-- Compact Stats -->
<th:block th:fragment="statsCompact(stats)">
    <div class="flex flex-wrap gap-4">
        <div th:each="stat : ${stats}" class="flex items-center gap-2 bg-base-200 rounded-lg px-3 py-2">
            <span th:if="${stat.icon != null}" th:utext="${stat.icon}"></span>
            <span class="font-bold" th:text="${stat.value}"></span>
            <span class="text-sm text-base-content/60" th:text="${stat.label}"></span>
        </div>
    </div>
</th:block>

<!-- Stats with Progress -->
<th:block th:fragment="statsProgress(label, current, target, unit)">
    <div class="bg-base-100 rounded-xl p-4 shadow-md">
        <div class="flex justify-between items-center mb-2">
            <span class="text-base-content/60" th:text="${label}">Label</span>
            <span class="font-bold">
                <span th:text="${current}"></span>
                <span class="text-base-content/50">/ <span th:text="${target}"></span></span>
                <span th:if="${unit}" class="text-sm" th:text="${unit}"></span>
            </span>
        </div>
        <progress class="progress progress-primary w-full" th:value="${(current * 100) / target}" max="100"></progress>
    </div>
</th:block>

<!-- Large Stats (Dashboard Hero) -->
<th:block th:fragment="statsHero(mainStat, secondaryStats)">
    <div class="bg-gradient-to-br from-primary/10 to-secondary/10 rounded-2xl p-6">
        <!-- Main Stat -->
        <div class="text-center mb-6">
            <p class="text-base-content/60 mb-1" th:text="${mainStat.label}">Label</p>
            <p class="text-5xl md:text-6xl font-bold text-gradient" th:text="${mainStat.value}">0</p>
            <p th:if="${mainStat.desc}" class="text-sm text-base-content/50 mt-2" th:text="${mainStat.desc}"></p>
        </div>

        <!-- Secondary Stats -->
        <div th:if="${secondaryStats != null}" class="grid grid-cols-3 gap-4 border-t border-base-300 pt-4">
            <div th:each="stat : ${secondaryStats}" class="text-center">
                <p class="text-xl font-bold" th:text="${stat.value}">0</p>
                <p class="text-xs text-base-content/60" th:text="${stat.label}"></p>
            </div>
        </div>
    </div>
</th:block>